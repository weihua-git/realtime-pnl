# 🤖 量化交易引擎

基于火币 API 的自动化量化交易系统，支持测试模式和实盘模式。

## ✨ 核心特性

- 🎯 **智能开仓**：基于多个技术指标（MA、RSI、MACD、布林带）自动判断交易信号
- 🛡️ **风险控制**：止损、止盈、移动止损三重保护
- 📊 **多周期分析**：综合短期、中期、长期趋势判断
- 🔄 **测试/实盘切换**：一键切换测试模式和实盘模式
- 📈 **实时监控**：持仓盈亏、交易统计实时显示
- 💰 **仓位管理**：灵活配置仓位大小和最大持仓数

## 🚀 快速开始

### 1. 安装依赖

```bash
npm install
```

### 2. 配置 API 密钥

在 `.env` 文件中配置：

```bash
HTX_ACCESS_KEY=your_access_key
HTX_SECRET_KEY=your_secret_key
```

### 3. 启动交易（测试模式）

```bash
npm run trade
```

**默认是测试模式**，使用模拟资金，不会真实下单。

### 4. 切换到实盘模式

编辑 `start-trading.js`：

```javascript
const config = {
  testMode: false, // 改为 false
  // ...
};
```

⚠️ **警告**：实盘模式会使用真实资金！

## 📋 配置说明

### 基础配置

```javascript
{
  testMode: true,        // 测试模式开关
  symbol: 'BTC-USDT',    // 交易对
  leverage: 5,           // 杠杆倍数
  initialBalance: 1000,  // 测试模式初始资金
}
```

### 仓位管理

```javascript
{
  positionSize: 0.1,     // 每次开仓 10%
  maxPositions: 1,       // 最大持仓数
}
```

### 风险控制

```javascript
{
  stopLoss: 0.02,        // 止损 2%
  takeProfit: 0.05,      // 止盈 5%
  trailingStop: 0.03,    // 移动止损 3%
}
```

## 📊 交易策略

### 开仓信号

**做多（看涨）**：
- ✅ 多周期趋势向上
- ✅ 均线多头排列
- ✅ RSI 超卖反弹
- ✅ MACD 金叉
- ✅ 价格触及布林带下轨

**做空（看跌）**：
- ❌ 多周期趋势向下
- ❌ 均线空头排列
- ❌ RSI 超买回调
- ❌ MACD 死叉
- ❌ 价格触及布林带上轨

**信心指数 > 60** 才会开仓。

### 平仓条件

1. **止损**：亏损达到 2% 自动平仓
2. **止盈**：盈利达到 5% 自动平仓
3. **移动止损**：从最高/最低点回撤 3% 平仓

## 📈 运行示例

### 启动界面

```
═══════════════════════════════════════════════════════
🚀 量化交易引擎启动
═══════════════════════════════════════════════════════
📊 交易对: BTC-USDT
🔧 模式: 测试模式 (模拟交易)
💰 初始资金: 1000.00 USDT
📈 杠杆倍数: 5x
📊 仓位大小: 10%
🛡️ 止损: 2%
🎯 止盈: 5%
📉 移动止损: 3%
═══════════════════════════════════════════════════════
```

### 实时状态

```
[2026-02-06 10:30:00] 📊 交易状态
💰 余额: 1050.23 USDT
💵 当前价格: 45230.50 USDT
📈 持仓数: 1/1

持仓详情:
  1. 🟢 LONG 0.0011 @ 45000.00 | 盈亏: 0.51%

📊 统计数据:
  总交易: 5 | 胜: 3 | 负: 2
  胜率: 60.00%
  总盈亏: 50.23 USDT (5.02%)
  最大回撤: 1.23%
```

### 交易信号

```
📈 检测到做多信号 (信心: 75%)
✅ 模拟开仓成功: LONG 0.0011 @ 45000.00

🎯 触发止盈: LONG @ 47250.00 (盈利 5.00%)
✅ 模拟平仓成功: LONG @ 47250.00 | 盈亏: 24.75 USDT (5.00%)
```

## 🎯 策略示例

### 保守策略

```javascript
{
  leverage: 3,           // 低杠杆
  positionSize: 0.05,    // 5% 仓位
  stopLoss: 0.015,       // 1.5% 止损
  takeProfit: 0.03,      // 3% 止盈
}
```

### 激进策略

```javascript
{
  leverage: 10,          // 高杠杆
  positionSize: 0.2,     // 20% 仓位
  stopLoss: 0.03,        // 3% 止损
  takeProfit: 0.08,      // 8% 止盈
}
```

### 多持仓策略

```javascript
{
  maxPositions: 3,       // 最多 3 个持仓
  positionSize: 0.1,     // 每次 10%
}
```

## ⚠️ 风险提示

1. **测试先行**：务必先在测试模式下验证策略
2. **小额试水**：首次实盘使用小额资金
3. **监控运行**：定期检查程序状态
4. **网络稳定**：确保网络连接稳定
5. **API 限制**：注意火币 API 调用频率

## 💡 优化建议

1. 根据市场波动调整止损止盈比例
2. 避免在重大新闻发布时运行
3. 不要把所有资金投入单一交易对
4. 定期回测策略表现
5. 记录交易日志，分析改进

## 📚 文档

- [量化交易使用指南](./docs/量化交易使用指南.md) - 详细使用说明
- [快速开始](./docs/快速开始.md) - 项目快速上手
- [常见问题解答](./docs/常见问题解答.md) - 常见问题

## 🛠️ 技术栈

- Node.js - 运行环境
- WebSocket - 实时行情
- 火币 API - 交易接口
- 技术指标 - MA、RSI、MACD、布林带

## 📝 许可证

MIT License

---

**免责声明**：本项目仅供学习交流使用，不构成投资建议。量化交易存在风险，请谨慎使用。
