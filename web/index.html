<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>HTX ç›‘æ§é…ç½®</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div id="app">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <header class="header">
      <h1>ğŸ“Š HTX ç›‘æ§é…ç½®</h1>
      <div class="tabs">
        <button 
          class="tab-btn" 
          :class="{ active: currentTab === 'config' }"
          @click="currentTab = 'config'">
          âš™ï¸ é…ç½®ç®¡ç†
        </button>
        <button 
          class="tab-btn" 
          :class="{ active: currentTab === 'analysis' }"
          @click="currentTab = 'analysis'">
          ğŸ“Š å¸‚åœºåˆ†æ
        </button>
        <button 
          class="tab-btn" 
          :class="{ active: currentTab === 'data' }"
          @click="currentTab = 'data'">
          ğŸ“ˆ æ•°æ®å±•ç¤º
        </button>
      </div>
    </header>

    <!-- é…ç½®ç®¡ç†é¡µé¢ -->
    <div v-show="currentTab === 'config'" class="container">
      
      <!-- ä»·æ ¼ç›®æ ‡ç›‘æ§ -->
      <section class="card">
        <div class="card-header">
          <h2>ğŸ¯ ä»·æ ¼ç›®æ ‡ç›‘æ§</h2>
          <label class="switch">
            <input type="checkbox" v-model="config.priceTargets.enabled">
            <span class="slider"></span>
          </label>
        </div>
        
        <div v-if="config.priceTargets.enabled" class="card-body">
          <div v-for="(target, index) in config.priceTargets.targets" :key="index" class="target-item">
            <div class="target-row">
              <select v-model="target.symbol" class="input">
                <option value="ETH-USDT">ETH-USDT</option>
                <option value="BTC-USDT">BTC-USDT</option>
                <option value="SOL-USDT">SOL-USDT</option>
                <option value="DOGE-USDT">DOGE-USDT</option>
                <option value="XRP-USDT">XRP-USDT</option>
              </select>
              
              <input 
                type="number" 
                v-model.number="target.targetPrice" 
                placeholder="ç›®æ ‡ä»·æ ¼"
                class="input"
                step="0.01">
              
              <select v-model="target.direction" class="input">
                <option value="above">è¾¾åˆ° â‰¥</option>
                <option value="below">è·Œç ´ â‰¤</option>
              </select>
              
              <button @click="removeTarget(index)" class="btn-delete">ğŸ—‘ï¸</button>
            </div>
            
            <!-- é«˜çº§é€‰é¡¹ -->
            <div class="target-advanced">
              <label class="checkbox-label">
                <input type="checkbox" v-model="target.notifyOnce">
                <span>åªé€šçŸ¥ä¸€æ¬¡ï¼ˆè§¦å‘åè‡ªåŠ¨ç§»é™¤ï¼‰</span>
              </label>
              
              <div v-if="!target.notifyOnce" class="sub-inputs">
                <div class="input-group">
                  <label>é€šçŸ¥é—´éš” (ç§’)</label>
                  <input 
                    type="number" 
                    v-model.number="target.notifyInterval" 
                    class="input-small"
                    min="0"
                    step="1"
                    placeholder="60">
                  <small class="input-hint">0 = æ¯æ¬¡éƒ½é€šçŸ¥ï¼ˆä¸æ¨èï¼‰</small>
                </div>
              </div>
              
              <div class="input-group">
                <label>ä»·æ ¼å¹…åº¦ (%)</label>
                <input 
                  type="number" 
                  v-model.number="target.rangePercent" 
                  class="input-small"
                  min="0"
                  max="100"
                  step="0.1"
                  placeholder="0">
                <small class="input-hint" v-if="target.rangePercent > 0 && target.direction === 'above'">
                  é€šçŸ¥èŒƒå›´: {{ target.targetPrice.toFixed(2) }} ~ {{ (target.targetPrice * (1 + target.rangePercent / 100)).toFixed(2) }} (è¶…å‡ºæ­¤èŒƒå›´åœæ­¢é€šçŸ¥)
                </small>
                <small class="input-hint" v-else-if="target.rangePercent > 0 && target.direction === 'below'">
                  é€šçŸ¥èŒƒå›´: {{ (target.targetPrice * (1 - target.rangePercent / 100)).toFixed(2) }} ~ {{ target.targetPrice.toFixed(2) }} (è¶…å‡ºæ­¤èŒƒå›´åœæ­¢é€šçŸ¥)
                </small>
                <small class="input-hint" v-else>
                  0 = æ— å¹…åº¦é™åˆ¶ï¼ŒæŒç»­é€šçŸ¥
                </small>
              </div>
            </div>
          </div>
          
          <button @click="addTarget" class="btn-add">â• æ·»åŠ ç›®æ ‡</button>
        </div>
      </section>

      <!-- ç›‘æ§åˆçº¦åˆ—è¡¨ -->
      <section class="card">
        <div class="card-header">
          <h2>ğŸ“‹ ç›‘æ§åˆçº¦åˆ—è¡¨</h2>
        </div>
        <div class="card-body">
          <div class="contract-list">
            <label v-for="contract in availableContracts" :key="contract" class="checkbox-label">
              <input 
                type="checkbox" 
                :value="contract"
                :checked="config.watchContracts.includes(contract)"
                @change="toggleContract(contract)">
              <span>{{ contract }}</span>
            </label>
          </div>
        </div>
      </section>

      <!-- å¤šæ—¶é—´çª—å£ç›‘æ§ -->
      <section class="card">
        <div class="card-header">
          <h2>â±ï¸ å¤šæ—¶é—´çª—å£ç›‘æ§</h2>
          <label class="switch">
            <input type="checkbox" v-model="config.priceChangeConfig.enabled">
            <span class="slider"></span>
          </label>
        </div>
        
        <div v-if="config.priceChangeConfig.enabled" class="card-body">
          <div class="info-box">
            <p>ğŸ“Š ç›‘æ§ä»·æ ¼åœ¨ä¸åŒæ—¶é—´çª—å£çš„å˜åŒ–å¹…åº¦</p>
          </div>
          
          <div v-for="(window, index) in config.priceChangeConfig.timeWindows" :key="index" class="window-item">
            <div class="window-label">{{ window.name }}</div>
            <div class="window-inputs">
              <div class="input-group">
                <label>å˜åŒ–å¹…åº¦ (%)</label>
                <input 
                  type="number" 
                  v-model.number="window.threshold" 
                  step="0.1"
                  class="input-small">
              </div>
              <div class="input-group">
                <label>å˜åŒ–é‡‘é¢ (USDT)</label>
                <input 
                  type="number" 
                  v-model.number="window.amountThreshold" 
                  step="0.1"
                  class="input-small">
              </div>
            </div>
          </div>
          
          <div class="input-group">
            <label>é€šçŸ¥é—´éš” (åˆ†é’Ÿ)</label>
            <input 
              type="number" 
              v-model.number="minNotifyIntervalMinutes" 
              class="input"
              min="1">
          </div>
        </div>
      </section>

      <!-- æŒä»“é€šçŸ¥é…ç½® -->
      <section class="card">
        <div class="card-header">
          <h2>ğŸ”” æŒä»“é€šçŸ¥é…ç½®</h2>
        </div>
        <div class="card-body">
          <div class="notification-grid">
            <div class="notification-item">
              <label class="checkbox-label">
                <input type="checkbox" v-model="config.notificationConfig.enableProfitNotification">
                <span>ç›ˆåˆ©é€šçŸ¥</span>
              </label>
              <div v-if="config.notificationConfig.enableProfitNotification" class="sub-inputs">
                <div class="input-group">
                  <label>ç›ˆåˆ©æ¯”ä¾‹ (%)</label>
                  <input 
                    type="number" 
                    v-model.number="config.notificationConfig.profitThreshold" 
                    class="input-small"
                    step="0.1">
                </div>
                <div class="input-group">
                  <label>ç›ˆåˆ©é‡‘é¢ (USDT)</label>
                  <input 
                    type="number" 
                    v-model.number="config.notificationConfig.profitAmountThreshold" 
                    class="input-small"
                    step="0.1">
                </div>
              </div>
            </div>

            <div class="notification-item">
              <label class="checkbox-label">
                <input type="checkbox" v-model="config.notificationConfig.enableLossNotification">
                <span>äºæŸé€šçŸ¥</span>
              </label>
              <div v-if="config.notificationConfig.enableLossNotification" class="sub-inputs">
                <div class="input-group">
                  <label>äºæŸæ¯”ä¾‹ (%)</label>
                  <input 
                    type="number" 
                    v-model.number="lossThresholdAbs" 
                    class="input-small"
                    step="0.1">
                </div>
                <div class="input-group">
                  <label>äºæŸé‡‘é¢ (USDT)</label>
                  <input 
                    type="number" 
                    v-model.number="lossAmountThresholdAbs" 
                    class="input-small"
                    step="0.1">
                </div>
              </div>
            </div>

            <div class="notification-item">
              <label class="checkbox-label">
                <input type="checkbox" v-model="config.notificationConfig.enableTimeNotification">
                <span>å®šæ—¶é€šçŸ¥</span>
              </label>
              <div v-if="config.notificationConfig.enableTimeNotification" class="sub-inputs">
                <div class="input-group">
                  <label>é—´éš” (åˆ†é’Ÿ)</label>
                  <input 
                    type="number" 
                    v-model.number="timeIntervalMinutes" 
                    class="input-small"
                    min="1">
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ä¿å­˜æŒ‰é’® -->
      <div class="save-section">
        <button @click="saveConfig" class="btn-save" :disabled="saving">
          {{ saving ? 'ä¿å­˜ä¸­...' : 'ğŸ’¾ ä¿å­˜é…ç½®' }}
        </button>
        <div v-if="saveMessage" class="save-message" :class="{ error: saveError }">
          {{ saveMessage }}
        </div>
      </div>
    </div>

    <!-- å¸‚åœºåˆ†æé¡µé¢ -->
    <div v-show="currentTab === 'analysis'" class="container">
      <section class="card">
        <div class="card-header">
          <h2>ğŸ“Š å¸‚åœºåˆ†æ</h2>
        </div>
        <div class="card-body">
          <div class="input-group">
            <label>é€‰æ‹©åˆçº¦</label>
            <select v-model="analysisSymbol" class="input">
              <option value="ETH-USDT">ETH-USDT</option>
              <option value="BTC-USDT">BTC-USDT</option>
              <option value="SOL-USDT">SOL-USDT</option>
              <option value="DOGE-USDT">DOGE-USDT</option>
              <option value="XRP-USDT">XRP-USDT</option>
            </select>
          </div>
          
          <div class="input-group">
            <label>å½“å‰ä»·æ ¼ï¼ˆå¯é€‰ï¼Œç•™ç©ºè‡ªåŠ¨è·å–ï¼‰</label>
            <input 
              type="number" 
              v-model.number="analysisPrice" 
              placeholder="ç•™ç©ºè‡ªåŠ¨è·å–å®æ—¶ä»·æ ¼"
              class="input"
              step="0.01">
          </div>
          
          <div class="input-group">
            <label>æŒä»“æˆæœ¬ï¼ˆå¯é€‰ï¼Œç•™ç©ºè‡ªåŠ¨è·å–ï¼‰</label>
            <input 
              type="number" 
              v-model.number="analysisCost" 
              placeholder="ç•™ç©ºè‡ªåŠ¨è·å–æŒä»“æˆæœ¬"
              class="input"
              step="0.01">
          </div>
          
          <button @click="loadAnalysis" class="btn-add" :disabled="analysisLoading">
            {{ analysisLoading ? 'åˆ†æä¸­...' : 'ğŸ” å¼€å§‹åˆ†æ' }}
          </button>
        </div>
      </section>

      <!-- åˆ†æç»“æœ -->
      <section v-if="analysisReport" class="card">
        <div class="card-header">
          <h2>ğŸ¤– æ™ºèƒ½äº¤æ˜“å»ºè®®</h2>
        </div>
        <div class="card-body">
          <div v-if="analysisReport.suggestion" class="suggestion-box">
            <div class="suggestion-action" :class="analysisReport.suggestion.action">
              <div class="action-icon">
                {{ analysisReport.suggestion.action === 'long' ? 'ğŸŸ¢' : analysisReport.suggestion.action === 'short' ? 'ğŸ”´' : 'ğŸŸ¡' }}
              </div>
              <div class="action-text">
                <h3>{{ getActionText(analysisReport.suggestion.action) }}</h3>
                <p>ä¿¡å¿ƒæŒ‡æ•°: {{ analysisReport.suggestion.confidence }}%</p>
              </div>
            </div>
            
            <div class="confidence-bar">
              <div class="bar-fill" :style="{ width: analysisReport.suggestion.confidence + '%' }"></div>
            </div>
            
            <div class="signals">
              <div class="signal-item">
                <span>ğŸ“ˆ çœ‹æ¶¨ä¿¡å·</span>
                <strong>{{ analysisReport.suggestion.signals.bullish }} åˆ†</strong>
              </div>
              <div class="signal-item">
                <span>ğŸ“‰ çœ‹è·Œä¿¡å·</span>
                <strong>{{ analysisReport.suggestion.signals.bearish }} åˆ†</strong>
              </div>
            </div>
            
            <div class="reasons">
              <h4>åˆ†æä¾æ®ï¼š</h4>
              <ul>
                <li v-for="(reason, index) in analysisReport.suggestion.reasons" :key="index">
                  {{ reason }}
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- å¤šæ—¶é—´çª—å£åˆ†æ -->
      <section v-if="analysisReport && analysisReport.multiTimeframe" class="card">
        <div class="card-header">
          <h2>ğŸ“ˆ å¤šæ—¶é—´çª—å£åˆ†æ</h2>
        </div>
        <div class="card-body">
          <div class="timeframe-list">
            <div v-for="tf in analysisReport.multiTimeframe" :key="tf.timeframe" class="timeframe-item">
              <span class="tf-name">{{ tf.timeframe }}</span>
              <span class="tf-change" :class="{ positive: tf.changePercent > 0, negative: tf.changePercent < 0 }">
                {{ tf.changePercent >= 0 ? '+' : '' }}{{ tf.changePercent.toFixed(2) }}%
              </span>
              <span class="tf-emoji">{{ tf.trend === 'up' ? 'ğŸ“ˆ' : 'ğŸ“‰' }}</span>
            </div>
          </div>
        </div>
      </section>

      <!-- ä»·æ ¼åŒºé—´åˆ†æ -->
      <section v-if="analysisReport && analysisReport.priceRange" class="card">
        <div class="card-header">
          <h2>ğŸ“Š ä»·æ ¼åŒºé—´åˆ†æ</h2>
        </div>
        <div class="card-body">
          <div v-for="range in analysisReport.priceRange" :key="range.timeframe" class="range-item">
            <h4>{{ range.timeframe }}</h4>
            <div class="range-info">
              <div>æœ€é«˜: {{ range.highest.toFixed(2) }}</div>
              <div>æœ€ä½: {{ range.lowest.toFixed(2) }}</div>
              <div>æŒ¯å¹…: {{ range.amplitude.toFixed(2) }}%</div>
            </div>
            <div class="position-bar">
              <div class="position-fill" :style="{ left: range.position + '%' }"></div>
            </div>
            <div class="position-text">å½“å‰ä½ç½®: {{ range.position.toFixed(0) }}%</div>
          </div>
        </div>
      </section>
    </div>

    <!-- æ•°æ®å±•ç¤ºé¡µé¢ï¼ˆå ä½ï¼‰ -->
    <div v-show="currentTab === 'data'" class="container">
      <section class="card">
        <div class="card-header">
          <h2>ğŸ“Š å®æ—¶æ•°æ®</h2>
        </div>
        <div class="card-body">
          <div class="placeholder">
            <p>ğŸš§ æ•°æ®å±•ç¤ºåŠŸèƒ½å¼€å‘ä¸­...</p>
            <p>å³å°†æ”¯æŒï¼š</p>
            <ul>
              <li>ğŸ“ˆ å®æ—¶æŒä»“ç›ˆäº</li>
              <li>ğŸ“Š ç›ˆäºæ›²çº¿å›¾</li>
              <li>ğŸ¯ ä»·æ ¼ç›‘æ§çŠ¶æ€</li>
              <li>ğŸ“‹ é€šçŸ¥å†å²è®°å½•</li>
            </ul>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
